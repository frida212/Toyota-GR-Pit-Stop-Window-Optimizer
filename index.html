<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Toyota GR Pit Stop Window Optimizer</title>
    <link rel="stylesheet" href="/static/styles.css" />
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  </head>
  <body>
    <header>
      <h1>Toyota GR Pit Stop Window Optimizer</h1>
      <p>Compute optimal single-stop lap considering traffic and tire wear.</p>
    </header>

    <main>
      <section class="card">
        <h2>Data Source</h2>
        <div class="row">
          <label>
            <input type="radio" name="source" value="server" checked />
            Load from site data folder
          </label>
          <label>
            <input type="radio" name="source" value="upload" />
            Upload CSVs manually
          </label>
        </div>

        <div id="server-controls" class="grid">
          <div>
            <label for="race">Race</label>
            <select id="race">
              <option value="R1">Race 1</option>
              <option value="R2">Race 2</option>
              <option value="both">Both</option>
            </select>
          </div>
        </div>

        <div id="upload-controls" class="grid hidden">
          <div>
            <label>Lap Time CSV</label>
            <input type="file" id="lap-time-file" accept=".csv" />
          </div>
          <div>
            <label>Lap Start Time CSV (optional)</label>
            <input type="file" id="lap-start-file" accept=".csv" />
          </div>
          <div>
            <label>Lap End Time CSV (optional)</label>
            <input type="file" id="lap-end-file" accept=".csv" />
          </div>
        </div>
      </section>

      <section class="card">
        <h2>Parameters</h2>
        <div class="grid">
          <div>
            <label for="pit-loss">Pit Lane Loss (s)</label>
            <input type="number" id="pit-loss" value="35" step="0.1" />
          </div>
          <div>
            <label for="service-time">Service Time (s)</label>
            <input type="number" id="service-time" value="25" step="0.1" />
          </div>
          <div>
            <label for="warmup">Out-lap Warmup (s)</label>
            <input type="number" id="warmup" value="1" step="0.1" />
          </div>
          <div>
            <label for="traffic-window">Traffic Window (s)</label>
            <input type="number" id="traffic-window" value="20" step="0.1" />
          </div>
          <div>
            <label for="traffic-threshold">Traffic Density Threshold</label>
            <input type="number" id="traffic-threshold" value="10" step="1" />
          </div>
          <div class="stretch">
            <button id="compute">Compute Optimal Pit Window</button>
          </div>
        </div>
      </section>

      <section class="card">
        <h2>Results</h2>
        <pre id="output">No results yet.</pre>
      </section>
    </main>

    <footer>
      <small>Upload CSVs or use the siteâ€™s data folder. Models are simplified for speed.</small>
    </footer>

    <script src="/static/optimizer.js"></script>
    <script src="/static/app.js"></script>
  </body>
  </html>